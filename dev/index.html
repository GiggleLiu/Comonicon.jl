<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Comonicon.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Comonicon.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Convention"><span>Convention</span></a></li><li><a class="tocitem" href="#Create-a-CLI-project"><span>Create a CLI project</span></a></li></ul></li><li><a class="tocitem" href="types/">Command Types</a></li><li><a class="tocitem" href="parse/">Command Parsing</a></li><li><a class="tocitem" href="codegen/">Code Generation</a></li><li><a class="tocitem" href="build/">Build and Install CLI</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Roger-luo/Comonicon.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comonicon"><a class="docs-heading-anchor" href="#Comonicon">Comonicon</a><a id="Comonicon-1"></a><a class="docs-heading-anchor-permalink" href="#Comonicon" title="Permalink"></a></h1><p><em>gith averminaluk ayh juldas mausan urdan</em></p><p><a href="https://travis-ci.com/Roger-luo/Comonicon.jl"><img src="https://travis-ci.com/Roger-luo/Comonicon.jl.svg?branch=master" alt="Build Status"/></a></p><p>Roger&#39;s magic book for command line interfaces.</p><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><p>The simplest and most common way to use <a href="@ref"><code>Comonicon</code></a> is to use <code>@cast</code> and <code>@main</code>. Let&#39;s use a simple example to show how, the following example creates a command using <code>@cast</code>.</p><pre><code class="language-julia">using Comonicon
@main function mycmd(arg; option=&quot;Sam&quot;, flag::Bool=false)
    @show arg
    @show option
    @show flag
end</code></pre><p>if you write this into a script file <code>myscript.jl</code> and execute it using</p><pre><code class="language-julia">julia myscript.jl -h</code></pre><p>You will see the following in your terminal.</p><pre><code class="language-none">  main

No documentation found.
mycmd is a Function.
# 1 method for generic function &quot;mycmd&quot;:
[1] mycmd(arg; option, flag) in Main at /Users/roger/.julia/dev/Comonicon/example/myscript.jl:2

Usage

  main [options...] [flags...] &lt;arg&gt;

Args

  &lt;arg&gt;

Flags

  -f,--flag

  -h, --help          print this help message

  -V, --version       print version information

Options

  --option &lt;::Any&gt;
</code></pre><p>Now let me explain what <code>@main</code> does here. In short it does the following things:</p><ul><li>parse your expression and create a command line object</li><li>use this command line object to create an entry</li><li>generate a Julia script to actually execute the command</li><li>cache the generated Julia script into a file so it won&#39;t need to recompile your code again</li></ul><h2 id="Convention"><a class="docs-heading-anchor" href="#Convention">Convention</a><a id="Convention-1"></a><a class="docs-heading-anchor-permalink" href="#Convention" title="Permalink"></a></h2><p><strong>leaf command</strong>: leaf commands are the commands at the last of the CLI that takes arguments, options and flags, e.g the <code>show</code> command below</p><p><strong>node command</strong>: node commands are the commands at the middle or first of the CLI that contains sub-commands, e.g the <code>remote</code> command below</p><pre><code class="language-sh">git remote show origin</code></pre><p><strong>arguments</strong>: arguments are command line arguments that required at the leaf command</p><p><strong>flags</strong>: flags are command line options that has no arguments, e.g <code>--flag</code> or <code>-f</code> (short flag).</p><p><strong>options</strong>: options are command line options that has arguments, e.g <code>--name Sam</code> or <code>-n Sam</code>, also <code>--name=Sam</code> or <code>-nSam</code>.</p><p>When used on function expressions, <code>@cast</code> and <code>@main</code> have the same convention on how they convert your expressions to commands, these are</p><ul><li>function arguments are parsed as command arguments:<ul><li>value will be converted automatically if arguments has type annotation</li><li>optional arguments are allowed</li></ul></li><li>function keyword arguments are parsed as command flags or options:<ul><li>keyword arguments must have default value</li><li>keyword arguments of type <code>Bool</code> can only have <code>false</code> as default value, which will be treated as flags that allow short flags.</li><li>value will be converted automatically if keyword arguments has type annotation</li></ul></li><li>function doc string can use section names: <strong>Arguments</strong>, <strong>Options</strong> and <strong>Flags</strong> to annotate your CLI:<ul><li>short options or short flags can be declared via <code>-f, flag</code> or <code>-o, --option &lt;name&gt;</code> (see example below)</li></ul></li></ul><p>An example of function docstring</p><pre><code class="language-julia">&quot;&quot;&quot;
my command line interface.

# Arguments

- `arg`: an argument

# Options

- `-o, --option`: an option that has short option.

# Flags

- `-f, --flag`: a flag that has short flag.
&quot;&quot;&quot;
@main function mycmd(arg; option=&quot;Sam&quot;, flag::Bool=false)
    @show arg
    @show option
    @show flag
end</code></pre><p>This will give a help message looks like below after execute this in <code>myscript.jl</code> via <code>julia myscript.jl</code></p><pre><code class="language-none">
  main

my command line interface.

Usage

  main [options...] [flags...] &lt;arg&gt;

Args

  &lt;arg&gt;                  an argument

Flags

  -f,--flag              a flag that has short flag.

  -h, --help             print this help message

  -V, --version          print version information

Options

  -o, --option &lt;name&gt;</code></pre><h2 id="Create-a-CLI-project"><a class="docs-heading-anchor" href="#Create-a-CLI-project">Create a CLI project</a><a id="Create-a-CLI-project-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-CLI-project" title="Permalink"></a></h2><p>However, to build better and faster CLI, you will want to build your CLI in a Julia package and deliver it to your users. This can be done via <code>@cast</code>.</p><p><code>@cast</code> is similar to <code>@main</code> before functions, but it won&#39;t execute anything, but only create the command and register the command to a global variable <code>CASTED_COMMANDS</code> in the current module. And it will create <code>NodeCommand</code>s before modules, and the sub-commands of the <code>NodeCommand</code> can be created via <code>@cast</code> inside the module.</p><p>After you create the commands via <code>@cast</code>, you can declare an entry at the bottom of your module via <code>@main</code>. A simple example looks like the following</p><pre><code class="language-julia">module Dummy

using Comonicon

@cast mycmd1(arg; option=&quot;Sam&quot;) = println(&quot;cmd1: arg=&quot;, arg, &quot;option=&quot;, option)
@cast mycmd2(arg; option=&quot;Sam&quot;) = println(&quot;cmd2: arg=&quot;, arg, &quot;option=&quot;, option)

module Cmd3

using Comonicon

@cast mycmd4(arg) = println(&quot;cmd4: arg=&quot;, arg)

end # module

@main name=&quot;dummy&quot; version=v&quot;0.1.0&quot;

end # module</code></pre><p>You can find all created commands via following</p><pre><code class="language-julia">julia&gt; Dummy.CASTED_COMMANDS
Dict{String,Any} with 3 entries:
  &quot;mycmd2&quot; =&gt; mycmd2 [options...] &lt;arg&gt;
  &quot;main&quot;   =&gt; dummy v0.1.0
  &quot;mycmd1&quot; =&gt; mycmd1 [options...] &lt;arg&gt;</code></pre><p>and you can execute the command via <code>Dummy.command_main</code> created by <code>@main</code>:</p><pre><code class="language-julia">julia&gt; Dummy.command_main([&quot;-h&quot;])

  dummy v0.1.0



Usage

  dummy &lt;command&gt;

Commands

  mycmd2 [options...] &lt;arg&gt;    No documentation found. Main.Dummy.mycmd2 is a
                               # 1 method for generic function &quot;mycmd2&quot;: [1]
                               option) in Main.Dummy at REPL[2]:6

  mycmd1 [options...] &lt;arg&gt;    No documentation found. Main.Dummy.mycmd1 is a
                               # 1 method for generic function &quot;mycmd1&quot;: [1]
                               option) in Main.Dummy at REPL[2]:5

Flags

  -h, --help                   print this help message

  -V, --version                print version information


0</code></pre><p>Then you can create a <code>build.jl</code> file in your package <code>deps</code> folder to install this command to <code>~/.julia/bin</code> when your user install your package. This will only need two line:</p><pre><code class="language-julia"># build.jl
using Comonicon, Dummy
Comonicon.install(Dummy, &quot;dummy&quot;)</code></pre><p>You can turn on the keyword <code>sysimg</code> to <code>true</code> to compile a system image for the CLI.</p><pre><code class="language-julia"># build.jl
using Comonicon, Dummy
Comonicon.install(Dummy, &quot;dummy&quot;; sysimg=true)</code></pre><p>There is an example project <a href="https://github.com/Roger-luo/IonCLI.jl">IonCLI.jl</a> you can take as a reference.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="types/">Command Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 8 September 2020 17:33">Tuesday 8 September 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
